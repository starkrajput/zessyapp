import{a as l}from"./chunk-7MR5CTEZ.js";import{Ta as u,e as i,gb as c,l as s,o as a,r as n}from"./chunk-UL3MO6E2.js";var p=class r{constructor(o,e){this.http=o;this.router=e;let t=localStorage.getItem("currentUser");t&&this.currentUserSubject.next(JSON.parse(t))}apiUrl=`${l.apiUrl}/api`;currentUserSubject=new i(null);currentUser$=this.currentUserSubject.asObservable();login(o,e){return this.http.post(`${this.apiUrl}/auth/login`,{username:o,password:e}).pipe(s(t=>{localStorage.setItem("token",t.token),localStorage.setItem("currentUser",JSON.stringify(t.user)),this.currentUserSubject.next(t.user)}))}logout(){localStorage.removeItem("token"),localStorage.removeItem("currentUser"),this.currentUserSubject.next(null),this.router.navigate(["/login"])}getToken(){return localStorage.getItem("token")}isLoggedIn(){return!!this.getToken()}getCurrentUser(){return this.currentUserSubject.value}static \u0275fac=function(e){return new(e||r)(n(u),n(c))};static \u0275prov=a({token:r,factory:r.\u0275fac,providedIn:"root"})};export{p as a};
